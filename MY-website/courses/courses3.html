<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>正弦定律计算器 - 我的教学网站</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        /* 正弦定律计算器样式 */
        .calculator-container {
            width: 100%;
            max-width: 700px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin: 2rem auto;
        }
        
        .calculator-header {
            padding: 20px;
            border-bottom: 1px solid #e5e5e5;
            text-align: center;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .calculator-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #0066cc;
        }
        
        .calculator-content {
            padding: 20px;
        }
        
        /* 公式容器 */
        .formula-container {
            text-align: center;
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background-color: #f9f9f9;
            border-radius: 0.5rem;
        }
        
        .formula-title {
            text-align: left;
            padding-left: 1rem;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }
        
        .formula-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
        }
        
        .fraction {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .numerator {
            border-bottom: 1px solid black;
        }
        
        .label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.25rem;
        }
        
        .input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #e5e5e5;
            border-radius: 0.25rem;
            margin-top: 0.25rem;
            font-size: 1rem;
        }
        
        .readonly {
            background-color: #f3f4f6;
        }
        
        .calculator-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }
        
        .space-y-4 > * + * {
            margin-top: 1rem;
        }
        
        .button-container {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .calc-button {
            padding: 0.5rem 1.5rem;
            border-radius: 0.25rem;
            font-weight: 500;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.2s;
        }
        
        .button-primary {
            background-color: #0066cc;
            color: white;
            border: none;
        }
        
        .button-primary:hover {
            background-color: #0055aa;
        }
        
        .button-outline {
            background-color: transparent;
            color: #0066cc;
            border: 1px solid #0066cc;
        }
        
        .button-outline:hover {
            background-color: #eff6ff;
        }
        
        .error {
            color: #ef4444;
            margin-top: 1rem;
        }
        
        .canvas-container {
            margin-top: 1rem;
            width: 100%;
        }
        
        canvas {
            border: 1px solid #e5e5e5;
            border-radius: 0.5rem;
            width: 100%;
        }
        
        .steps {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #f9f9f9;
            border-radius: 0.5rem;
            font-family: monospace;
            font-size: 0.875rem;
            white-space: pre-wrap;
        }
        
        .formula-note {
            font-size: 0.875rem;
            margin-top: 1rem;
        }
        
        select {
            padding: 0.25rem 0.5rem;
            border: 1px solid #e5e5e5;
            border-radius: 0.25rem;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <img src="../images/LOGO.jpeg" alt="我的教学网站Logo" width="180">
            </div>
            <nav>
                <ul>
                    <li><a href="../index.html">首页</a></li>
                    <li><a href="../about.html">关于我们</a></li>
                    <li><a href="index.html">课程</a></li>
                </ul>
            </nav>
        </div>
    </header>
    
    <main>
        <div class="container">
            <section>
                <h2>课程三：正弦定律计算器</h2>
                <p>这个计算器工具使用正弦定律解决三角形问题，可以帮助学生理解和应用三角学原理。</p>
                <p>使用此工具可以：</p>
                <ul>
                    <li>根据两条边和一个角度计算另一个角度</li>
                    <li>根据一条边和两个角度计算另一条边</li>
                    <li>可视化展示三角形</li>
                    <li>显示计算步骤，帮助学习</li>
                </ul>
            </section>
            
            <div class="calculator-container">
                <div class="calculator-header">
                    <div class="header-content">
                        <h2 class="calculator-title">非凡教育</h2>
                        <select id="mode-select">
                            <option value="angle">Find Angle / 计算角度</option>
                            <option value="length">Find Length / 计算长度</option>
                        </select>
                    </div>
                </div>
                <div class="calculator-content">
                    <div class="formula-container">
                        <div class="formula-title">公式 / Formula:</div>
                        <div class="formula-display">
                            <div class="fraction">
                                <div class="numerator">sin A</div>
                                <div>a</div>
                            </div>
                            <div>=</div>
                            <div class="fraction">
                                <div class="numerator">sin B</div>
                                <div>b</div>
                            </div>
                            <div>=</div>
                            <div class="fraction">
                                <div class="numerator">sin C</div>
                                <div>c</div>
                            </div>
                        </div>
                        <div class="formula-note">两长两度 using Sine Rules</div>
                    </div>
                    
                    <div class="calculator-grid">
                        <div class="space-y-4">
                            <div>
                                <label class="label">边长 a / Side a:</label>
                                <input
                                    type="number"
                                    id="side-a"
                                    class="input"
                                    placeholder="输入长度 / Enter length"
                                />
                            </div>
                            <div>
                                <label class="label">角度 A / Angle A (°):</label>
                                <input
                                    type="number"
                                    id="angle-a"
                                    class="input"
                                    placeholder="输入角度 / Enter angle"
                                />
                            </div>
                        </div>
                        <div class="space-y-4" id="angle-mode-inputs">
                            <div>
                                <label class="label">边长 b / Side b:</label>
                                <input
                                    type="number"
                                    id="side-b-input"
                                    class="input"
                                    placeholder="输入长度 / Enter length"
                                />
                            </div>
                            <div>
                                <label class="label">角度 B / Angle B (°):</label>
                                <input
                                    type="number"
                                    id="angle-b-output"
                                    class="input readonly"
                                    placeholder="自动计算 / Auto-calculated"
                                    readonly
                                />
                            </div>
                        </div>
                        <div class="space-y-4" id="length-mode-inputs" style="display: none;">
                            <div>
                                <label class="label">角度 B / Angle B (°):</label>
                                <input
                                    type="number"
                                    id="angle-b-input"
                                    class="input"
                                    placeholder="输入角度 / Enter angle"
                                />
                            </div>
                            <div>
                                <label class="label">边长 b / Side b:</label>
                                <input
                                    type="number"
                                    id="side-b-output"
                                    class="input readonly"
                                    placeholder="自动计算 / Auto-calculated"
                                    readonly
                                />
                            </div>
                        </div>
                    </div>
                
                    <div class="button-container">
                        <button 
                            id="calculate-btn"
                            class="calc-button button-primary"
                        >
                            计算 / Calculate
                        </button>
                        <button 
                            id="random-btn"
                            class="calc-button button-outline"
                        >
                            随机值 / Random
                        </button>
                    </div>
                
                    <div id="error" class="error" style="display: none;"></div>
                
                    <div class="canvas-container">
                        <canvas
                            id="triangleCanvas"
                            width="400"
                            height="300"
                        ></canvas>
                    </div>
                
                    <div id="calculation-steps" class="steps" style="display: none;"></div>
                </div>
            </div>
        </div>
    </main>
    
    <footer>
        <div class="container">
            <p>&copy; 2025 我的教学网站. 保留所有权利.</p>
        </div>
    </footer>

    <script>
        // DOM elements
        const modeSelect = document.getElementById('mode-select');
        const angleModeInputs = document.getElementById('angle-mode-inputs');
        const lengthModeInputs = document.getElementById('length-mode-inputs');
        const sideAInput = document.getElementById('side-a');
        const angleAInput = document.getElementById('angle-a');
        const sideBInput = document.getElementById('side-b-input');
        const angleBOutput = document.getElementById('angle-b-output');
        const angleBInput = document.getElementById('angle-b-input');
        const sideBOutput = document.getElementById('side-b-output');
        const calculateBtn = document.getElementById('calculate-btn');
        const randomBtn = document.getElementById('random-btn');
        const errorDiv = document.getElementById('error');
        const calculationStepsDiv = document.getElementById('calculation-steps');
        const canvas = document.getElementById('triangleCanvas');
        const ctx = canvas.getContext('2d');
        
        // Initialize state
        let mode = 'angle';
        let values = {
            sideA: '',
            angleA: '',
            sideB: '',
            angleB: ''
        };
        
        // Event listeners
        modeSelect.addEventListener('change', (e) => {
            mode = e.target.value;
            if (mode === 'angle') {
                angleModeInputs.style.display = 'block';
                lengthModeInputs.style.display = 'none';
            } else {
                angleModeInputs.style.display = 'none';
                lengthModeInputs.style.display = 'block';
            }
            resetForm();
        });
        
        sideAInput.addEventListener('change', (e) => {
            values.sideA = e.target.value;
        });
        
        angleAInput.addEventListener('change', (e) => {
            values.angleA = e.target.value;
        });
        
        sideBInput.addEventListener('change', (e) => {
            values.sideB = e.target.value;
        });
        
        angleBInput.addEventListener('change', (e) => {
            values.angleB = e.target.value;
        });
        
        calculateBtn.addEventListener('click', calculate);
        randomBtn.addEventListener('click', generateRandomValues);
        
        // Functions
        function resetForm() {
            values = {
                sideA: '',
                angleA: '',
                sideB: '',
                angleB: ''
            };
            sideAInput.value = '';
            angleAInput.value = '';
            sideBInput.value = '';
            angleBOutput.value = '';
            angleBInput.value = '';
            sideBOutput.value = '';
            calculationStepsDiv.style.display = 'none';
            errorDiv.style.display = 'none';
            clearCanvas();
        }
        
        function generateRandomValues() {
            if (mode === 'angle') {
                const newSideA = (Math.random() * 10 + 5).toFixed(2);
                const newSideB = (Math.random() * 10 + 5).toFixed(2);
                const newAngleA = (Math.random() * 60 + 30).toFixed(2);
                
                values = {
                    sideA: newSideA,
                    sideB: newSideB,
                    angleA: newAngleA,
                    angleB: ''
                };
                
                sideAInput.value = newSideA;
                sideBInput.value = newSideB;
                angleAInput.value = newAngleA;
                angleBOutput.value = '';
            } else {
                const newSideA = (Math.random() * 10 + 5).toFixed(2);
                const newAngleA = (Math.random() * 60 + 30).toFixed(2);
                const newAngleB = (Math.random() * 60 + 30).toFixed(2);
                
                values = {
                    sideA: newSideA,
                    angleA: newAngleA,
                    angleB: newAngleB,
                    sideB: ''
                };
                
                sideAInput.value = newSideA;
                angleAInput.value = newAngleA;
                angleBInput.value = newAngleB;
                sideBOutput.value = '';
            }
            
            calculationStepsDiv.style.display = 'none';
            errorDiv.style.display = 'none';
            clearCanvas();
        }
        
        function calculate() {
            if (mode === 'angle') {
                calculateAngleB();
            } else {
                calculateSideB();
            }
        }
        
        function calculateAngleB() {
            const a = parseFloat(values.sideA);
            const A = parseFloat(values.angleA);
            const b = parseFloat(values.sideB);
            
            if (!a || !A || !b) {
                setError('请输入所有必填值 / Please enter all required values');
                calculationStepsDiv.style.display = 'none';
                return;
            }
        
            try {
                const sinB = (b * Math.sin(A * Math.PI / 180)) / a;
                const B = Math.asin(sinB) * 180 / Math.PI;
        
                if (isNaN(B) || !isFinite(B)) {
                    setError('无效的三角形 / Invalid triangle');
                    calculationStepsDiv.style.display = 'none';
                    return;
                }
        
                if (B <= 0 || B >= 180) {
                    setError('角度范围无效 / Invalid angle range');
                    calculationStepsDiv.style.display = 'none';
                    return;
                }
        
                values.angleB = B.toFixed(2);
                angleBOutput.value = B.toFixed(2);
                clearError();
        
                const steps = `
计算角度B的步骤 / Steps to calculate angle B:

1) 使用正弦定律公式 / Using sine rule formula:

   sin B    sin A
   —————— = ——————
     b        a

   sin B = b × sin A
          ————————————————————————
                    a

2) 代入数值 / Substituting values:

   sin B = ${b} × sin(${A}°)
          ————————————————————————
                ${a}

   sin B = ${b} × ${Math.sin(A * Math.PI / 180).toFixed(4)}
          ————————————————————————
                ${a}

   sin B = ${sinB.toFixed(4)}
   B = sin⁻¹ ${sinB.toFixed(4)}
   B = ${B.toFixed(2)}°`;
                
                calculationStepsDiv.textContent = steps;
                calculationStepsDiv.style.display = 'block';
                
                drawTriangle();
            } catch (err) {
                setError('计算错误 / Calculation error');
                calculationStepsDiv.style.display = 'none';
            }
        }
        
        function calculateSideB() {
            const a = parseFloat(values.sideA);
            const A = parseFloat(values.angleA);
            const B = parseFloat(values.angleB);
            
            if (!a || !A || !B) {
                setError('请输入所有必填值 / Please enter all required values');
                calculationStepsDiv.style.display = 'none';
                return;
            }
        
            try {
                if (A <= 0 || A >= 180 || B <= 0 || B >= 180) {
                    setError('角度无效 / Invalid angles');
                    calculationStepsDiv.style.display = 'none';
                    return;
                }
        
                const b = (a * Math.sin(B * Math.PI / 180)) / Math.sin(A * Math.PI / 180);
        
                if (isNaN(b) || !isFinite(b)) {
                    setError('无效的三角形 / Invalid triangle');
                    calculationStepsDiv.style.display = 'none';
                    return;
                }
        
                values.sideB = b.toFixed(2);
                sideBOutput.value = b.toFixed(2);
                clearError();
        
                const steps = `
计算边长b的步骤 / Steps to calculate side b:

1) 使用正弦定律公式 / Using sine rule formula:

   sin B    sin A
   —————— = ——————
     b        a

   b = a × sin B
       ————————————————————————
           sin A

2) 代入数值 / Substituting values:

   b = ${a} × sin(${B}°)
       ————————————————————————
           sin(${A}°)

   b = ${a} × ${Math.sin(B * Math.PI / 180).toFixed(4)}
       ————————————————————————
       ${Math.sin(A * Math.PI / 180).toFixed(4)}

   b = ${b.toFixed(4)}`;
                
                calculationStepsDiv.textContent = steps;
                calculationStepsDiv.style.display = 'block';
                
                drawTriangle();
            } catch (err) {
                setError('计算错误 / Calculation error');
                calculationStepsDiv.style.display = 'none';
            }
        }
        
        function setError(message) {
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }
        
        function clearError() {
            errorDiv.style.display = 'none';
        }
        
        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
        
        function drawTriangle() {
            clearCanvas();
            
            let a, A, b, B;
            
            if (mode === 'angle') {
                a = parseFloat(values.sideA);
                A = parseFloat(values.angleA) * Math.PI / 180;
                b = parseFloat(values.sideB);
                B = parseFloat(values.angleB) * Math.PI / 180;
            } else {
                a = parseFloat(values.sideA);
                A = parseFloat(values.angleA) * Math.PI / 180;
                b = parseFloat(values.sideB);
                B = parseFloat(values.angleB) * Math.PI / 180;
            }
            
            if (!a || !A || !b || !B) return;
            
            // Calculate the third angle (C)
            const C = Math.PI - A - B;
            
            // Scale and center the triangle
            const width = canvas.width;
            const height = canvas.height;
            const scale = Math.min(width, height) / Math.max(a, b) * 0.4;
            const centerX = width / 2;
            const centerY = height / 2;
        
            // Calculate vertices
            const x1 = centerX - (a * scale / 2);
            const y1 = centerY + (a * scale / 3);
            const x2 = x1 + a * scale;
            const y2 = y1;
            const x3 = x1 + b * scale * Math.cos(A);
            const y3 = y1 - b * scale * Math.sin(A);
        
            // Draw triangle
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.lineTo(x3, y3);
            ctx.closePath();
            ctx.strokeStyle = '#0066cc';
            ctx.lineWidth = 2;
            ctx.stroke();
        
            // Add labels
            ctx.font = '14px Arial';
            ctx.fillStyle = '#000';
            
            // Side labels
            ctx.fillText(`a: ${parseFloat(values.sideA).toFixed(2)}`, (x1 + x2) / 2, y1 + 20);
            
            if (mode === 'angle') {
                ctx.fillText(`b: ${parseFloat(values.sideB).toFixed(2)}`, (x1 + x3) / 2 - 10, (y1 + y3) / 2);
            } else {
                ctx.fillText(`b: ${parseFloat(values.sideB).toFixed(2)}`, (x1 + x3) / 2 - 10, (y1 + y3) / 2);
            }
            
            // Angle labels
            ctx.fillText(`A: ${parseFloat(values.angleA).toFixed(1)}°`, x2 - 20, y2 - 10);
            
            if (mode === 'angle') {
                ctx.fillText(`B: ${parseFloat(values.angleB).toFixed(1)}°`, x1 - 40, y1 - 10);
            } else {
                ctx.fillText(`B: ${parseFloat(values.angleB).toFixed(1)}°`, x1 - 40, y1 - 10);
            }
        }
        
        // Initialize event listeners for input fields to update values
        sideAInput.addEventListener('input', function(e) {
            values.sideA = e.target.value;
        });
        
        angleAInput.addEventListener('input', function(e) {
            values.angleA = e.target.value;
        });
        
        sideBInput.addEventListener('input', function(e) {
            values.sideB = e.target.value;
        });
        
        angleBInput.addEventListener('input', function(e) {
            values.angleB = e.target.value;
        });
    </script>
</body>
</html>